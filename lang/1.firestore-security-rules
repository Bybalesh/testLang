Prism.languages['firestore-security-rules'] = Prism.languages.extend('clike', {
	'comment': /\/\/.*/,
	'keyword': /\b(?:allow|function|if|match|null|return|rules_version|service)\b/,
	'operator': /&&|\|\||[<>!=]=?|[-+*/%]|\b(?:in|is)\b/,
});

delete Prism.languages['firestore-security-rules']['class-name'];
service cloud.firestore {
  match /databases/{database}/documents {
    // Доступ разрешен всем пользователям
    match /{document=**} {
      allow read, write: if true;
    }
    
    // Ограничиваем доступ к документам 'users'
    match /users/{userId} {
      allow read, write: if request.auth.uid == userId;
    }
  }
}

	},
	'method': {
		// to make the pattern shorter, the actual method names are omitted
		pattern: /(\ballow\s+)[a-z]+(?:\s*,\s*[a-z]+)*(?=\s*[:;])/,
		lookbehind: true,
		alias: 'builtin',
		inside: {
			'punctuation': /,/
		}
	},
});
